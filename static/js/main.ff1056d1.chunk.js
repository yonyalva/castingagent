(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){},30:function(e,t,n){e.exports=n(51)},35:function(e,t,n){},39:function(e,t,n){},41:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(25),o=n.n(i),c=n(16),l=(n(35),n(9)),s=n.n(l),u=n(12),d=n(1),m=n(2),h=n(5),p=n(4),f=n(6),g=n(19),v=(n(39),n(41),function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("header",null,r.a.createElement("nav",null,r.a.createElement("h1",null,"CASTING AGENCY")))}}]),t}(a.Component)),b=n(13),E=n(7),y=n.n(E),k=n(26),w=n(27),j=n.n(w),O=new(function(){function e(){Object(d.a)(this,e),this.auth0=new k.a.WebAuth({domain:"dev-6id39aor.auth0.com",audience:"castingapi",clientID:"KdG7NgFNyBEdKo0SqE2WRWciKmyDSUqe",redirectUri:"http://localhost:3000/callback",responseType:"token id_token",scope:"openid profile"}),this.getProfile=this.getProfile.bind(this),this.handleAuthentication=this.handleAuthentication.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this),this.signIn=this.signIn.bind(this),this.signOut=this.signOut.bind(this)}return Object(m.a)(e,[{key:"getProfile",value:function(){return this.profile}},{key:"getIdToken",value:function(){return this.idToken}},{key:"getToken",value:function(){return localStorage.getItem("JWTS_LOCAL_KEY")}},{key:"getPermission",value:function(){return this.payload}},{key:"isAuthenticated",value:function(){return(new Date).getTime()<this.expiresAt}},{key:"signIn",value:function(){this.auth0.authorize()}},{key:"check_token_fragment",value:function(){var e=window.location.hash.substr(1).split("&")[0].split("=");"access_token"===e[0]&&(this.token=e[1],this.set_jwt())}},{key:"set_jwt",value:function(){localStorage.setItem("JWTS_LOCAL_KEY",this.token),this.token&&this.decodeJWT(this.token)}},{key:"load_jwts",value:function(){this.token=localStorage.getItem("JWTS_LOCAL_KEY")||null,this.token&&this.decodeJWT(this.token)}},{key:"decodeJWT",value:function(e){return this.payload=j()(this.token),this.payload}},{key:"handleAuthentication",value:function(){var e=this;return new Promise(function(t,n){e.auth0.parseHash(function(a,r){return a?n(a):r&&r.idToken?(e.setSession(r),void t()):n(a)})})}},{key:"setSession",value:function(e){this.idToken=e.idToken,this.profile=e.idTokenPayload,this.expiresAt=1e3*e.idTokenPayload.exp}},{key:"signOut",value:function(){this.auth0.logout({returnTo:"http://localhost:3000",clientID:"KdG7NgFNyBEdKo0SqE2WRWciKmyDSUqe"}),localStorage.removeItem("JWTS_LOCAL_KEY")}},{key:"silentAuth",value:function(){var e=this;return new Promise(function(t,n){e.auth0.checkSession({},function(a,r){if(a)return n(a);e.setSession(r),t()})})}},{key:"can",value:function(e){return this.payload&&this.payload.permissions&&this.payload.permissions.length&&this.payload.permissions.indexOf(e)>=0}}]),e}()),C=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).getMovies=function(){y.a.ajax({url:"https://castingya.herokuapp.com/movies",type:"GET",success:function(e){n.setState({movies:e.movies})},error:function(e){alert("Unable to load movies. Please try your request again")}})},n.movieAction=function(e){return function(t){"DELETE"===t&&window.confirm("are you sure you want to delete this movie?")&&y.a.ajax({url:"https://castingya.herokuapp.com/movies/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"DELETE",success:function(e){n.getMovies()},error:function(e){alert("Unable to delete the movie. Please try your request again")}})}},n.updateMovie=function(e){return function(t){t.preventDefault(),y.a.ajax({url:"https://castingya.herokuapp.com/movies/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify({title:n.state.title,release_date:n.state.release_date}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){window.location.reload(!1)},error:function(e){alert("Unable to update the movie. Please try your request again")}})}},n.handleChange=function(e){n.setState(Object(b.a)({},e.target.name,e.target.value))},n.showform=function(e){var t=n.state.movies.filter(function(t){return t.id===e.id})[0];document.querySelector("#title").value=t.title,document.querySelector("#release_date").value=t.release_date;var a=document.querySelector("#id").value=t.id;y()(".form-visible").show(),y()(".dborder3").hide(),y()(".button-visible").hide(),n.setState({id:a})},n.state={movies:[]},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMovies();case 2:return e.next=4,O.load_jwts();case 4:return e.next=6,O.check_token_fragment();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"navTo",value:function(e){window.location.href=window.location.origin+e}},{key:"render",value:function(){var e=this,t=this.state.id;return r.a.createElement("div",{id:"display"},r.a.createElement("div",{className:"dborder boxshw cardwi",id:"someDivId"},O.can("post:movies")&&r.a.createElement("button",{type:"button",className:"button-visible roles-visible",onClick:function(){e.navTo("/addmovie")},title:"add a new movie"},"Add a new movie"),r.a.createElement("form",{className:"form-view form-visible",onSubmit:this.updateMovie(t)},r.a.createElement("label",null,"Title",r.a.createElement("input",{type:"text",name:"title",id:"title",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Release date",r.a.createElement("input",{type:"date",name:"release_date",id:"release_date",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Id",r.a.createElement("input",{type:"text",size:"4",name:"id",id:"id",onChange:this.handleChange,readOnly:!0})),r.a.createElement("input",{type:"submit",className:"button",value:"Save"})),this.state.movies&&this.state.movies.map(function(t,n){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"dborder3"},r.a.createElement("ul",{className:"listnone"},r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Title"),": ",r.a.createElement("span",null,t.title),O.can("patch:movies")&&r.a.createElement("img",{src:"images/edit.png",alt:"edit",title:"Edit this movie",className:"edit",onClick:function(){return e.showform(t)}})),r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Release date"),": ",r.a.createElement("span",null,t.release_date),O.can("delete:movies")&&r.a.createElement("img",{src:"images/delete.png",alt:"delete",title:"Delete this movie",className:"delete",onClick:function(){return e.movieAction(t.id)("DELETE")}})))))})))}}]),t}(a.Component),T=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).getActors=function(){y.a.ajax({url:"https://castingya.herokuapp.com/actors",type:"GET",success:function(e){n.setState({actors:e.actors})},error:function(e){alert("Unable to load actors. Please try your request again")}})},n.actorAction=function(e){return function(t){"DELETE"===t&&window.confirm("are you sure you want to delete this actor?")&&y.a.ajax({url:"https://castingya.herokuapp.com/actors/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"DELETE",success:function(e){n.getActors()},error:function(e){alert("Unable to delete the actor. Please try your request again")}})}},n.updateActor=function(e){return function(t){t.preventDefault(),y.a.ajax({url:"https://castingya.herokuapp.com/actors/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify({name:n.state.name,age:n.state.age,gender:n.state.gender}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){window.location.reload(!1)},error:function(e){alert("Unable to update the actor. Please try your request again")}})}},n.handleChange=function(e){n.setState(Object(b.a)({},e.target.name,e.target.value))},n.showform=function(e){var t=n.state.actors.filter(function(t){return t.id===e.id})[0];document.querySelector("#name").value=t.name,document.querySelector("#age").value=t.age,document.querySelector("#gender").value=t.gender;var a=document.querySelector("#id").value=t.id;y()(".form-visible").show(),y()(".dborder3").hide(),y()(".button-visible").hide(),n.setState({id:a})},n.state={actors:[]},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getActors();case 2:return e.next=4,O.load_jwts();case 4:return e.next=6,O.check_token_fragment();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"navTo",value:function(e){window.location.href=window.location.origin+e}},{key:"render",value:function(){var e=this,t=this.state.id;return r.a.createElement("div",{id:"display"},r.a.createElement("div",{className:"dborder boxshw cardwi"},O.can("post:actors")&&r.a.createElement("button",{type:"button",className:"button-visible roles-visible",onClick:function(){e.navTo("/addactor")},title:"add a new actor"},"Add a new actor"),r.a.createElement("form",{className:"form-view form-visible",onSubmit:this.updateActor(t)},r.a.createElement("label",null,"Name",r.a.createElement("input",{type:"text",name:"name",id:"name",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Age",r.a.createElement("input",{type:"number",name:"age",id:"age",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Gender",r.a.createElement("input",{type:"text",name:"gender",id:"gender",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Id",r.a.createElement("input",{type:"text",size:"4",name:"id",id:"id",onChange:this.handleChange,readOnly:!0})),r.a.createElement("input",{type:"submit",className:"button",value:"Save"})),this.state.actors&&this.state.actors.map(function(t,n){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"dborder3"},r.a.createElement("ul",{className:"listnone"},r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Name"),": ",r.a.createElement("span",{id:"name"},t.name),O.can("patch:actors")&&r.a.createElement("img",{src:"images/edit.png",alt:"edit",title:"Edit this actor",className:"edit",onClick:function(){return e.showform(t)}})),r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Age"),": ",r.a.createElement("span",{id:"age"},t.age)),r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Gender"),": ",r.a.createElement("span",{id:"gender"},t.gender),O.can("delete:actors")&&r.a.createElement("img",{src:"images/delete.png",alt:"delete",title:"Delete this actor",className:"delete",onClick:function(){return e.actorAction(t.id)("DELETE")}})))))})))}}]),t}(a.Component),A=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"navTo",value:function(e){window.location.href=window.location.origin+e}},{key:"render",value:function(e){var t=this;return r.a.createElement("div",{className:"options-box"},r.a.createElement("div",{align:"center",role:"listitem",tabIndex:"4",className:"sidebar-item",onKeyPress:function(e){"Enter"===e.key&&t.navTo("")},onClick:function(){t.navTo("")}},r.a.createElement("strong",null,"Movies"),r.a.createElement("br",null),r.a.createElement("img",{src:"images/movies.png",alt:"movies"})),r.a.createElement("div",{align:"center",role:"listitem",tabIndex:"5",className:"sidebar-item",onKeyPress:function(e){"Enter"===e.key&&t.navTo("/actors")},onClick:function(){t.navTo("/actors")}},r.a.createElement("strong",null,"Actors"),r.a.createElement("br",null),r.a.createElement("img",{src:"images/actors.jpg",alt:"actors"})),r.a.createElement("div",{align:"center",role:"listitem",tabIndex:"6",className:"sidebar-item"},!O.isAuthenticated()&&r.a.createElement("button",{onClick:O.signIn},"Sign In"),O.isAuthenticated()&&r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){O.signOut(),e.history.replace("/")}},"Sign Out"),r.a.createElement("label",null,O.getProfile().name))))}}]),t}(a.Component),S=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",{id:"footer"},r.a.createElement("strong",null,"Casting Agency"),". Made with ",r.a.createElement("strong",null,"React & Flask API"))}}]),t}(a.Component),x=(n(23),function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this))).submitMovie=function(e){e.preventDefault(),y.a.ajax({url:"https://castingya.herokuapp.com/movies_new",headers:{Authorization:"Bearer ".concat(O.getToken())},type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({title:n.state.title,release_date:n.state.release_date}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){document.getElementById("add-movie-form").reset()},error:function(e){alert("Unable to add the movie. Please try your request again")}})},n.handleChange=function(e){n.setState(Object(b.a)({},e.target.name,e.target.value))},n.state={title:"",release_date:""},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"add-form"},r.a.createElement("h2",null,"Add a new movie"),r.a.createElement("form",{className:"form-view",id:"add-movie-form",onSubmit:this.submitMovie},r.a.createElement("label",null,"Title",r.a.createElement("input",{type:"text",name:"title",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Release date",r.a.createElement("input",{type:"date",name:"release_date",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))}}]),t}(a.Component)),N=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this))).submitActor=function(e){e.preventDefault(),y.a.ajax({url:"https://castingya.herokuapp.com/actors_new",headers:{Authorization:"Bearer ".concat(O.getToken())},type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({name:n.state.name,age:n.state.age,gender:n.state.gender}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){document.getElementById("add-actor-form").reset()},error:function(e){alert("Unable to add the actor. Please try your request again")}})},n.handleChange=function(e){n.setState(Object(b.a)({},e.target.name,e.target.value))},n.state={name:"",age:"",gender:""},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"add-form"},r.a.createElement("h2",null,"Add a new actor"),r.a.createElement("form",{className:"form-view",id:"add-actor-form",onSubmit:this.submitActor},r.a.createElement("label",null,"Name",r.a.createElement("input",{type:"text",name:"name",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Age",r.a.createElement("input",{type:"number",name:"age",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Gender",r.a.createElement("input",{type:"text",name:"gender",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))}}]),t}(a.Component),_=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.handleAuthentication();case 2:return e.next=4,O.load_jwts();case 4:return e.next=6,O.check_token_fragment();case 6:this.props.history.replace("/");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("p",null,"Loading profile...")}}]),t}(a.Component),q=Object(g.f)(_),D=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={checkingSession:!0},n}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("./components/callback"!==this.props.location.pathname){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,O.silentAuth();case 5:this.forceUpdate(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),"login_required"!==e.t0.error&&console.log(e.t0.error);case 11:case"end":return e.stop()}},e,this,[[2,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement(c.a,null,r.a.createElement(g.c,null,r.a.createElement(g.a,{path:"/",exact:!0,component:C}),r.a.createElement(g.a,{path:"/actors",component:T}),r.a.createElement(g.a,{path:"/addmovie",component:x}),r.a.createElement(g.a,{path:"/addactor",component:N}),r.a.createElement(g.a,{exact:!0,path:"/callback",component:q}),r.a.createElement(g.a,{component:C}))),r.a.createElement(A,null),r.a.createElement(S,null))}}]),t}(a.Component),P=Object(g.f)(D),I=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function W(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(c.a,null,r.a.createElement(P,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/reactcats",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/reactcats","/service-worker.js");I?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):W(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):W(t,e)})}}()}},[[30,2,1]]]);
//# sourceMappingURL=main.ff1056d1.chunk.js.map